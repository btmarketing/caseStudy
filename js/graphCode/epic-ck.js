////////////////////////////////////
////////////////////////////////////
////////////////////////////////////
function startEpic(){var e=4e3;epic_vis.selectAll("circle.innerCircle").transition().duration(e).attr("r",function(e){return epicInnerSmall(e.percentage)});for(var t=0;t<epic_data.length;t++){var n=epic_data[t].x*epic_w,r=epic_data[t].y*epic_h,i=epic_data[t].percentage*2+5;for(var s=0;s<i;s++){var o=(t+Math.floor(Math.random()*(epic_data.length-1)))%epic_data.length,u=epic_data[o].x*epic_w,a=epic_data[o].y*epic_h,f=(u-n)/2+n,l=(a-r)/2+r,c=e/2/i*Math.floor(Math.random()*i);epic_vis.append("circle").attr("class","epic_packet").attr("fill","white").attr("cx",u).attr("cy",a).attr("opacity",.5).attr("r",0).transition().ease("cubic-in").delay(c).duration(e/4).attr("cx",f).attr("cy",l).attr("r",2).attr("opacity",1).transition().ease("cubic-out").duration(e/4).attr("cx",n).attr("cy",r).attr("opacity",.5).attr("r",0).each("end",function(){this.remove()})}}}function endEpic(){for(var e=0;e<epic_data.length;e++)epic_vis.select("#epic_innerCircle_"+e).attr("r",0)}function openEpicCircle(e,t){d3.select("#epic_innerCircle_"+t).transition().duration(200).attr("r",function(e){return epicInnerBig(e.percentage)});d3.select("#epic_outerCircle_"+t).transition().duration(300).attr("r",function(e){return epicOuterBig(e.percentage)});d3.select("#epic_text_"+t).transition().duration(500).attr("opacity",1);d3.select("#countryDisplay").text(e.country).transition().duration(200).attr("opacity",.7)}function closeEpicCircle(e,t){d3.select("#epic_innerCircle_"+t).transition().duration(600).attr("r",function(e,t){return epicInnerSmall(e.percentage)});d3.select("#epic_outerCircle_"+t).transition().duration(1e3).attr("r",0);d3.select("#epic_text_"+t).transition().duration(200).attr("opacity",0);d3.select("#countryDisplay").transition().duration(200).attr("opacity",0)}function epicInnerSmall(e){return e*.6+5}function epicInnerBig(e){return(e+10)*1.5}function epicOuterBig(e){return(e+10)*1.5+10}var epic_data=[{country:"USA",percentage:9,x:.22,y:.43},{country:"Russia",percentage:15,x:.75,y:.3},{country:"Argentina",percentage:6,x:.3,y:.85},{country:"Spain",percentage:4,x:.46,y:.4},{country:"India",percentage:3,x:.66,y:.5},{country:"Italy",percentage:3,x:.5,y:.4},{country:"Ukraine",percentage:2,x:.55,y:.4},{country:"Canada",percentage:2,x:.22,y:.26},{country:"Turkey",percentage:2,x:.55,y:.46}];document.getElementById("epicMap").style.width=unitSize*4-gutter*2-40+"px";document.getElementById("epicMap").style.height=unitSize*2-gutter*2-40+"px";document.getElementById("epicMap").style.position="absolute";document.getElementById("epicMap").style.left="20px";document.getElementById("epicMap").style.top="20px";var epicDisplay=!0;setInterval(function(){if(document.getElementById("epicGraph").offsetWidth){if(!epicDisplay){epicDisplay=!0;startEpic()}}else if(epicDisplay){epicDisplay=!1;endEpic()}},500);var epic_w=unitSize*4-gutter*2,epic_h=unitSize*2-gutter*2,epic_r=80,epic_vis=d3.select("#epicMeal_div").append("svg:svg").attr("id","epicGraph").attr("width",epic_w).attr("height",epic_h),epicSVG=document.getElementById("epicGraph");epicSVG.style.position="absolute";epicSVG.style.left="0px";epicSVG.style.top="0px";epic_vis.selectAll("circle.outerCircle").data(epic_data).enter().append("circle").attr("class","outerCircle").attr("id",function(e,t){return"epic_outerCircle_"+t}).attr("cx",function(e){return e.x*epic_w}).attr("cy",function(e){return e.y*epic_h}).attr("fill","white").attr("opacity",.3).attr("r",0).on("mouseover",function(e,t){openEpicCircle(e,t)}).on("mouseout",function(e,t){closeEpicCircle(e,t)});epic_vis.selectAll("circle.innerCircle").data(epic_data).enter().append("circle").attr("class","innerCircle").attr("id",function(e,t){return"epic_innerCircle_"+t}).attr("cx",function(e){return e.x*epic_w}).attr("cy",function(e){return e.y*epic_h}).attr("opacity",.6).attr("fill","white").attr("r",0).on("mouseover",function(e,t){openEpicCircle(e,t)}).on("mouseout",function(e,t){closeEpicCircle(e,t)});epic_vis.selectAll("text.epic_text").data(epic_data).enter().append("text").attr("class","epic_text").attr("id",function(e,t){return"epic_text_"+t}).attr("opacity",0).attr("fill","rgb(125,109,180)").attr("font-size",function(e){return Math.floor(epicInnerBig(e.percentage)*.9)+"px"}).attr("text-anchor","middle").text(function(e){return e.percentage+"%"}).attr("x",function(e){return e.x*epic_w}).attr("y",function(e){var t=epicInnerBig(e.percentage)*.3;return e.y*epic_h+t}).on("mouseover",function(e,t){openEpicCircle(e,t)}).on("mouseout",function(e,t){closeEpicCircle(e,t)}).attr("font-family","Helvetica");epic_vis.append("text").attr("id","countryDisplay").attr("opacity",0).attr("font-size","25px").attr("text-anchor","middle").attr("fill","white").attr("x",function(){return Math.floor(epic_w/2)+"px"}).attr("y",function(){return epic_h-5+"px"}).attr("font-family","Helvetica");