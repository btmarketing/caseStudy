////////////////////////////////////////////////
////////////////////////////////////////////////
////////////////////////////////////////////////
function startBones(){bones_vis.selectAll("path").transition().duration(1e3).attr("d",bones_arc)}function endBones(){bones_vis.selectAll("path").attr("d",bones_arcStart);bones_vis.selectAll("text").attr("opacity",0)}function bones_cancelAllTransitions(e){bones_vis.selectAll(e).each(function(){var e=this.__transition__;e&&(e.active=0)})}function bones_mouseover(){bones_mouseOn=!0;bones_cancelAllTransitions("path");bones_vis.selectAll("g.bt").select("path").transition().duration(300).attr("d",bones_arcBig);bones_vis.selectAll("g.other").select("path").transition().duration(300).attr("d",bones_arcSmall);bones_cancelAllTransitions("circle");bones_cancelAllTransitions("line");d3.selectAll(".bones_circleOuter").transition().duration(200).attr("r",30);d3.selectAll(".bones_circleInner").transition().duration(300).attr("r",20).each("end",function(){if(bones_mouseOn){d3.select("#bonesSVG").selectAll("text.bones_percentage").transition().duration(200).attr("opacity",1);d3.selectAll(".bones_lineOne").attr("opacity",.7).attr("x2",70).transition().duration(200).ease("linear").attr("x2",function(e){return e.label==="BitTorrent"?bones_w/3:bones_w*.5}).each("end",function(){bones_mouseOn&&d3.selectAll(".bones_lineTwo").attr("opacity",.7).attr("x2",function(e){return e.label==="BitTorrent"?bones_w/3:bones_w*.5}).attr("y2",function(e){return e.label==="BitTorrent"?bones_h*.2:bones_h*.8}).transition().duration(200).ease("linear").attr("x2",function(e){return e.label==="BitTorrent"?bones_w*.4:bones_w*.6}).attr("y2",function(e){return e.label==="BitTorrent"?bones_h*.4:bones_h*.6})})}})}function bones_mouseout(){bones_mouseOn=!1;bones_cancelAllTransitions("path");bones_vis.selectAll("g.bt").select("path").transition().duration(200).attr("d",bones_arc);bones_vis.selectAll("g.other").select("path").transition().duration(200).attr("d",bones_arc);bones_cancelAllTransitions("circle");d3.selectAll(".bones_circleInner").transition().duration(100).attr("r",0);d3.selectAll(".bones_circleOuter").transition().duration(200).attr("r",0);bones_cancelAllTransitions("line");d3.selectAll(".bones_lineOne").attr("opacity",0);d3.selectAll(".bones_lineTwo").attr("opacity",0);bones_cancelAllTransitions("text");d3.select("#bonesSVG").selectAll("text.bones_percentage").transition().duration(100).attr("opacity",0)}var bonesDisplay=!1;setInterval(function(){if(document.getElementById("bonesGraph").offsetWidth){if(!bonesDisplay){bonesDisplay=!0;startBones()}}else if(bonesDisplay){bonesDisplay=!1;endBones()}},500);var bones_w=unitSize*4-gutter*2-40,bones_h=unitSize*2-gutter*2-40,bones_r=65,color=d3.scale.category20c(),vas=d3.select("#bonesGraph").append("svg:svg").attr("id","bonesSVG"),bonesSVG=document.getElementById("bonesGraph");bonesSVG.style.position="absolute";bonesSVG.style.left="20px";bonesSVG.style.top="20px";var bones_data=[{label:"Other",value:64,color:"rgb(125,109,180)"},{label:"BitTorrent",value:36,color:"rgb(145,129,200)"}],bones_vis=d3.select("#bonesSVG").data([bones_data]).attr("width",bones_w).attr("height",bones_h).append("g").attr("transform","translate("+bones_w/2+","+bones_h/2+")"),bones_arc=d3.svg.arc().outerRadius(bones_r),bones_arcBig=d3.svg.arc().outerRadius(bones_r+5),bones_arcSmall=d3.svg.arc().outerRadius(bones_r-2),bones_arcStart=d3.svg.arc().outerRadius(bones_r-bones_r),bones_pie=d3.layout.pie().value(function(e){return e.value}),bones_arcs=bones_vis.selectAll("g.slice").data(bones_pie).enter().append("svg:g").attr("class",function(e){return e.value<50?"slice bt":"slice other"});bones_arcs.append("svg:path").attr("fill",function(e){return e.data.color}).attr("d",bones_arcStart);d3.select("#bonesSVG").selectAll("text.bones_label").data(bones_data).enter(0).append("svg:text").attr("class","bones_label").attr("fill","white").attr("opacity",1).attr("text-anchor","end").attr("font-size","13px").attr("font-family","Helvetica").attr("y",function(e){return e.value===36?15:40}).attr("x",function(){return bones_w-30}).text(function(e,t){return bones_data[t].label});d3.select("#bonesSVG").selectAll("rect.bones_rectLabel").data(bones_data).enter().append("rect").attr("class","bones_rectLabel").attr("fill",function(e){return e.color}).attr("x",function(){return bones_w-30+7}).attr("y",function(e){return e.value===36?1:26}).attr("width",20).attr("height",20);d3.select("#bonesSVG").selectAll("circle.bones_circleOuter").data(bones_data).enter().append("circle").attr("class","bones_circleOuter").attr("fill","white").attr("opacity",.1).attr("r",0).attr("cy",function(e){return e.label==="BitTorrent"?bones_h*.2:bones_h*.8}).attr("cx",50);d3.select("#bonesSVG").selectAll("circle.bones_circleInner").data(bones_data).enter().append("circle").attr("class","bones_circleInner").attr("fill","white").attr("opacity",.1).attr("r",0).attr("cy",function(e){return e.label==="BitTorrent"?bones_h*.2:bones_h*.8}).attr("cx",50);d3.select("#bonesSVG").selectAll("text.bones_percentage").data(bones_data).enter().append("text").attr("class","bones_percentage").attr("fill","white").attr("text-anchor","middle").attr("font-size",13).attr("opacity",0).attr("x",50).attr("y",function(e){return e.label==="BitTorrent"?bones_h*.2+5:bones_h*.8+5}).text(function(e){return e.value+"%"});d3.select("#bonesSVG").selectAll("line.bones_lineOne").data(bones_data).enter().append("line").attr("class","bones_lineOne").attr("stroke","white").attr("opacity",0).attr("stroke-width",2).attr("x1",70).attr("x2",function(e){return e.label==="BitTorrent"?bones_w/3:bones_w*.5}).attr("y1",function(e){return e.label==="BitTorrent"?bones_h*.2:bones_h*.8}).attr("y2",function(e){return e.label==="BitTorrent"?bones_h*.2:bones_h*.8});d3.select("#bonesSVG").selectAll("line.bones_lineTwo").data(bones_data).enter().append("line").attr("class","bones_lineTwo").attr("stroke","white").attr("opacity",0).attr("stroke-width",2).attr("x1",function(e){return e.label==="BitTorrent"?bones_w/3:bones_w*.5}).attr("x2",function(e){return e.label==="BitTorrent"?bones_w*.4:bones_w*.6}).attr("y1",function(e){return e.label==="BitTorrent"?bones_h*.2:bones_h*.8}).attr("y2",function(e){return e.label==="BitTorrent"?bones_h*.4:bones_h*.6});d3.select("#bonesSVG").append("rect").attr("id","bones_overlay").attr("opacity",0).attr("x",0).attr("y",0).attr("width",bones_w).attr("height",bones_h).on("mouseover",bones_mouseover).on("mouseout",bones_mouseout);var bones_mouseOn=!1;