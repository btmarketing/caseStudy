<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">

        <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

        <link rel="stylesheet" href="css/style.css">
        <link href='http://fonts.googleapis.com/css?family=Lekton:400,700,400italic' rel='stylesheet' type='text/css'>
        <script src="js/vendor/modernizr-2.6.2.min.js"></script>
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->

        <!-- Add your site or application content here -->
        <div id="wrapper">
            <header>
                <img class="logo" src="img/logo.png"><a class="logotext" href=""><h1>The <strong>BitTorrent</strong>&reg; Report</h1></a>
                <nav>
                    <ul class="nav" id="navigation">
                    </ul>
                </nav>
            </header>
            <div id="main">
                <canvas id="canvas"></canvas>
                <div id="content">
                    <!-- start Bucket -->
                    <div class="bucket">
                        <div class="title">
                            <h1>Bucket_0</h1>
                        </div>
                        <div class="rect_1">
                        </div>
                        <div class="rect_2">
                        </div>
                        <div class="double_1">
                        </div>
                        <div class="double_2">
                        </div>
                        <div class="big">
                        </div>
                        <div class="unit_1">
                        </div>
                        <div class="unit_2">
                        </div>
                        <div class="long">
                        </div>
                    </div> <!-- end Bucket -->
                    <!-- start Bucket -->
                    <div class="bucket">
                        <div class="title">
                            <h1>Bucket_1</h1>
                        </div>
                        <div class="rect_1">
                        </div>
                        <div class="rect_2">
                        </div>
                        <div class="double_1">
                        </div>
                        <div class="double_2">
                        </div>
                        <div class="big">
                        </div>
                        <div class="unit_1">
                        </div>
                        <div class="unit_2">
                        </div>
                        <div class="long">
                        </div>
                    </div> <!-- end Bucket -->
                </div><!-- end content storage -->
            </div><!-- END MAIN -->
            <footer>

            </footer> 

            <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
            <script>window.jQuery || document.write('<script src="js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
            <script src="js/plugins.js"></script>
            <script src="js/main.js"></script>
            <script type="text/javascript" src="js/coordinates.js"></script>
            <script type="text/javascript" src="js/contentBox.js"></script>
            <script type="text/javascript" src="js/bucket.js"></script>
            <script type="text/javascript" src="js/canvasStuff.js"></script>

            <script type="text/javascript">

            ////////////////////////////////////////////////
            ////////////////////////////////////////////////
            ////////////////////////////////////////////////

            //GLOBAL VARIABLES

            var theWidth;
            var theHeight;
            var center;

            var unitSize = 95;

            var currentCoords = 0;

            ////////////////////////////////////////////////
            ////////////////////////////////////////////////
            ////////////////////////////////////////////////

            window.onload = function(){
                initCanvas();
                resized();
                createBuckets();
                masterLoop();
            }

            ////////////////////////////////////////////////
            ////////////////////////////////////////////////
            ////////////////////////////////////////////////

            var buckets = [];

            //loop through the content divs, creating a new Bucket object for each section

            function createBuckets(){
                var domBuckets = document.getElementById('content').children;
                for(var i=0;i<domBuckets.length;i++){
                    if(domBuckets[i].className==='bucket'){
                        var isLast = false;
                        if(i===domBuckets.length-1) isLast = true;
                        var b = new Bucket(domBuckets[i],i,isLast);
                        buckets.push(b);
                    }
                }
            }

            ////////////////////////////////////////////////
            ////////////////////////////////////////////////
            ////////////////////////////////////////////////

            var count = 0;

            function masterLoop(){
                resizeText();
                for(var i=0;i<buckets.length;i++){
                    buckets[i].updateTitleBox();
                    buckets[i].updateContentBoxes();
                }
                drawSeeding();
                requestAnimFrame(masterLoop);
            }

            ////////////////////////////////////////////////
            ////////////////////////////////////////////////
            ////////////////////////////////////////////////

            //called from within the selected nav link
            //this function resets the global currentNavBox variable

            var currentNavigation = -1;
            var currentCoords = 0;

            function changeNavigation(index){
                if(currentNavigation!==index){
                    currentCoords = (currentCoords+1)%coordinates.length;
                    if(buckets[currentNavigation]){
                        buckets[currentNavigation].deselect();
                        currentNavigation=index;
                        buckets[currentNavigation].select(false);
                    }
                    else{
                        currentNavigation=index;
                        buckets[currentNavigation].select(true);
                    }
                }
            }

            ////////////////////////////////////////////////
            ////////////////////////////////////////////////
            ////////////////////////////////////////////////

            function resizeText(){
                var main = document.getElementById('main').getBoundingClientRect();
                if(center.oldLeft!==main.left || center.oldTop!==main.top){
                    resized(main);
                }
            }

            ////////////////////////////////////////////////
            ////////////////////////////////////////////////
            ////////////////////////////////////////////////

            function resized(main){

                if(!main) main = document.getElementById('main').getBoundingClientRect();

                theWidth = window.innerWidth;
                theHeight = window.innerHeight;

                var padding = 20;

                center = {
                    'x': main.left+unitSize*3+padding,
                    'y': main.top+unitSize*2+padding,
                    'left': main.left+padding,
                    'top': main.top+padding,
                    'oldLeft': main.left,
                    'oldTop': main.top
                };

                canvas.style.left = center.left+'px';
                canvas.style.top = center.top+'px';
            }

            ////////////////////////////////////////////////
            ////////////////////////////////////////////////
            ////////////////////////////////////////////////

            window.requestAnimFrame = (function(){
                return  window.requestAnimationFrame||window.webkitRequestAnimationFrame ||
                    window.mozRequestAnimationFrame||function(callback){
                        window.setTimeout(callback, 1000 / 60);
                    };
            })();

            ////////////////////////////////////////////////
            ////////////////////////////////////////////////
            ////////////////////////////////////////////////

        </script>
            <!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->

            <script>
                var _gaq=[['_setAccount','UA-XXXXX-X'],['_trackPageview']];
                (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
                g.src='//www.google-analytics.com/ga.js';
                s.parentNode.insertBefore(g,s)}(document,'script'));
            </script>
        </div>
    </body>
</html>
